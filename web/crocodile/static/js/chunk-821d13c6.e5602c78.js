(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-821d13c6"],{"1b4f":function(t,e,a){"use strict";var i=a("6eba"),l=a.n(i);l.a},2528:function(t,e,a){},2562:function(t,e,a){},4282:function(t,e,a){"use strict";var i=a("e3cc"),l=a.n(i);l.a},"4a41":function(t,e,a){},"4d1b":function(t,e,a){"use strict";var i=a("beeb"),l=a.n(i);l.a},"6e49":function(t,e,a){"use strict";var i=a("2562"),l=a.n(i);l.a},"6eba":function(t,e,a){},"864d":function(t,e,a){},b199:function(t,e,a){"use strict";a.d(e,"h",(function(){return l})),a.d(e,"d",(function(){return s})),a.d(e,"a",(function(){return n})),a.d(e,"e",(function(){return r})),a.d(e,"k",(function(){return o})),a.d(e,"m",(function(){return c})),a.d(e,"f",(function(){return u})),a.d(e,"i",(function(){return p})),a.d(e,"j",(function(){return d})),a.d(e,"l",(function(){return h})),a.d(e,"g",(function(){return v})),a.d(e,"c",(function(){return m})),a.d(e,"b",(function(){return b}));var i=a("b775");function l(t){return Object(i["a"])({url:"/api/v1/task",method:"get",params:t})}function s(t){return Object(i["a"])({url:"/api/v1/task",method:"post",data:t})}function n(t){return Object(i["a"])({url:"/api/v1/task",method:"put",data:t})}function r(t){return Object(i["a"])({url:"/api/v1/task",method:"delete",data:t})}function o(t){return Object(i["a"])({url:"/api/v1/task/kill",method:"put",data:t})}function c(t){return Object(i["a"])({url:"/api/v1/task/run",method:"put",data:t})}function u(t){return Object(i["a"])({url:"/api/v1/task/running",method:"get",params:t})}function p(t){return Object(i["a"])({url:"/api/v1/task/log",method:"get",params:t})}function d(t){return Object(i["a"])({url:"/api/v1/task/log/tree",method:"get",params:t})}function h(t){return Object(i["a"])({url:"/api/v1/task/cron",method:"get",params:t})}function v(){return Object(i["a"])({url:"/api/v1/task/select",method:"get"})}function m(t){return Object(i["a"])({url:"/api/v1/task/clone",method:"post",data:t})}function b(t){return Object(i["a"])({url:"/api/v1/task/log",method:"delete",data:t})}},b325:function(t,e,a){"use strict";var i=a("864d"),l=a.n(i);l.a},beeb:function(t,e,a){},bf7f:function(t,e,a){"use strict";var i=a("2528"),l=a.n(i);l.a},c430:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[!0===t.is_create||1==t.is_change?a("div",{staticStyle:{"margin-left":"25px","margin-right":"80px"}},[a("el-form",{ref:"task",attrs:{model:t.task,rules:t.rules,"label-position":"right","label-width":"120px",size:"mini"}},[a("el-form-item",{attrs:{label:"任务名称",prop:"name"}},[a("el-input",{staticStyle:{width:"500px"},attrs:{disabled:t.is_change||t.is_preview,placeholder:"请输入任务名称(建议任务名称格式为:标签_名字,方便后续搜索查找)",clearable:""},model:{value:t.task.name,callback:function(e){t.$set(t.task,"name",e)},expression:"task.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"任务类型",prop:"task_type",placeholder:"请选择任务类型"}},[a("el-select",{attrs:{disabled:t.is_preview,clearable:""},on:{change:t.changetaskdata},model:{value:t.task.task_type,callback:function(e){t.$set(t.task,"task_type",e)},expression:"task.task_type"}},t._l(t.task_typeoption,(function(t){return a("el-option",{key:t.label,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),a("div",{staticStyle:{"margin-left":"80px","margin-right":"40px"}},[1===t.task.task_type?a("div",[a("ul",[a("el-select",{attrs:{disabled:t.is_preview,size:"mini"},on:{change:t.changelang},model:{value:t.savecode.lang,callback:function(e){t.$set(t.savecode,"lang",e)},expression:"savecode.lang"}},t._l(t.langoption,(function(t){return a("el-option",{key:t.label,attrs:{label:t.label,value:t.value}})})),1),t._v(" "),2===t.savecode.lang?a("span",{staticClass:"sub-title"},[t._v("\n              所选主机组内的所有主机必须已经安装python3\n            ")]):t._e(),t._v(" "),3===t.savecode.lang?a("span",{staticClass:"sub-title"},[t._v("\n              所选主机组内的所有主机必须已经安装golang,支持并开启Go Module\n            ")]):t._e(),t._v(" "),a("div",{staticStyle:{"margin-top":"5px"}},[a("el-card",{attrs:{"body-style":{padding:"0px"}}},[a("editor",{attrs:{theme:"solarized_dark",lang:t.lang[t.savecode.lang],height:"300",options:{readOnly:t.is_preview}},on:{init:t.initEditor},model:{value:t.savecode.code,callback:function(e){t.$set(t.savecode,"code",e)},expression:"savecode.code"}})],1),t._v(" "),a("br")],1)],1)]):t._e(),t._v(" "),2===t.task.task_type?a("div",[a("ul",[a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{size:"mini",data:t.methodurl,"empty-text":"please press add new"}},[a("el-table-column",{attrs:{label:"Method","min-width":"15px;"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-select",{attrs:{disabled:t.is_preview,size:"mini",placeholder:"请选择"},model:{value:t.saveapi.method,callback:function(e){t.$set(t.saveapi,"method",e)},expression:"saveapi.method"}},t._l(t.methodoption,(function(t){return a("el-option",{key:t.label,attrs:{label:t.label,value:t.value}})})),1)]}}],null,!1,4206965964)}),t._v(" "),a("el-table-column",{attrs:{label:"URL","min-width":"100px;"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{disabled:t.is_preview,size:"mini"},model:{value:t.saveapi.url,callback:function(e){t.$set(t.saveapi,"url",e)},expression:"saveapi.url"}})]}}],null,!1,2605513936)})],1)],1),t._v(" "),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{size:"mini",data:t.headerlist,"empty-text":" "}},[a("el-table-column",{attrs:{prop:"name",label:"Header List","min-width":"100px;"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{disabled:t.is_preview,size:"mini"},model:{value:t.headerlist[e.$index].key,callback:function(a){t.$set(t.headerlist[e.$index],"key",a)},expression:"headerlist[scope.$index].key"}})]}}],null,!1,1470335600)}),t._v(" "),a("el-table-column",{attrs:{prop:"age","min-width":"100px;"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{disabled:t.is_preview,size:"mini"},model:{value:t.headerlist[e.$index].value,callback:function(a){t.$set(t.headerlist[e.$index],"value",a)},expression:"headerlist[scope.$index].value"}})]}}],null,!1,3904955724)}),t._v(" "),a("el-table-column",{attrs:{width:"70px;"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{disabled:t.is_preview,size:"mini",icon:"el-icon-delete",type:"info",circle:""},on:{click:function(a){return t.deleteheaderRow(e.$index)}}})]}}],null,!1,526775431)})],1),t._v(" "),a("div",{staticStyle:{"margin-left":"11px"}},[a("el-button",{attrs:{disabled:t.is_preview,type:"info",size:"mini"},on:{click:t.addheader}},[t._v("Add New")])],1)],1),t._v(" "),!1===["GET","HEAD"].includes(t.saveapi.method)?a("div",[a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{size:"mini",data:t.content_typetable,"empty-text":" "}},[a("el-table-column",{attrs:{prop:"name",label:"Content Type","min-width":"100px;"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:t.is_preview,size:"mini",filterable:""},on:{change:t.edit_header},model:{value:t.content_type,callback:function(e){t.content_type=e},expression:"content_type"}},t._l(t.content_typeoption,(function(t){return a("el-option",{key:t.label,attrs:{label:t.label,value:t.value}})})),1)]}}],null,!1,2606180087)})],1)],1),t._v(" "),"application/x-www-form-urlencoded"==t.content_type?a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{size:"mini",data:t.formlist,"empty-text":" "}},[a("el-table-column",{attrs:{prop:"name",label:"Form List","min-width":"100px;"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{disabled:t.is_preview,size:"mini"},model:{value:t.formlist[e.$index].key,callback:function(a){t.$set(t.formlist[e.$index],"key",a)},expression:"formlist[scope.$index].key"}})]}}],null,!1,680913113)}),t._v(" "),a("el-table-column",{attrs:{prop:"age","min-width":"100px;"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{disabled:t.is_preview,size:"mini"},model:{value:t.formlist[e.$index].value,callback:function(a){t.$set(t.formlist[e.$index],"value",a)},expression:"formlist[scope.$index].value"}})]}}],null,!1,3988284005)}),t._v(" "),a("el-table-column",{attrs:{width:"70px;"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{disabled:t.is_preview,size:"mini",icon:"el-icon-delete",type:"info",circle:""},on:{click:function(a){return t.deleteformRow(e.$index)}}})]}}],null,!1,1214274990)})],1),t._v(" "),a("div",{staticStyle:{"margin-left":"11px"}},[a("el-button",{attrs:{disabled:t.is_preview,type:"info",size:"mini"},on:{click:t.addform}},[t._v("Add New")])],1)],1):t._e(),t._v(" "),"application/json"==t.content_type?a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{size:"mini",data:t.bodylist,"empty-text":" "}},[a("el-table-column",{attrs:{prop:"name",label:"Raw Requesy Body","min-width":"100px;"}},[a("el-card",{attrs:{"body-style":{padding:"0px"}}},[a("editor",{attrs:{theme:"solarized_dark",lang:"json",height:"300",options:{readOnly:t.is_preview}},on:{init:t.initEditor},model:{value:t.jsonplayload,callback:function(e){t.jsonplayload=e},expression:"jsonplayload"}})],1)],1)],1)],1):t._e()]):t._e()])]):t._e()]),t._v(" "),a("el-row",[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:"父任务",prop:"parent_taskids"}},[a("el-select",{attrs:{disabled:t.is_preview,multiple:"",filterable:""},model:{value:t.task.parent_taskids,callback:function(e){t.$set(t.task,"parent_taskids",e)},expression:"task.parent_taskids"}},t._l(t.taskselect,(function(t){return a("el-option",{key:t.label,attrs:{label:t.label,value:t.value}})})),1)],1)],1),t._v(" "),a("el-col",{attrs:{span:11}},[0!=t.task.parent_taskids.length?a("el-form-item",{attrs:{label:"父任务运行策略",prop:"parent_runparallel"}},[a("el-select",{attrs:{disabled:t.is_preview},model:{value:t.task.parent_runparallel,callback:function(e){t.$set(t.task,"parent_runparallel",e)},expression:"task.parent_runparallel"}},t._l(t.parallelrun,(function(t){return a("el-option",{key:t.label,attrs:{label:t.label,value:t.value}})})),1)],1):t._e()],1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:"子任务",prop:"child_taskids"}},[a("el-select",{attrs:{disabled:t.is_preview,multiple:"",filterable:""},model:{value:t.task.child_taskids,callback:function(e){t.$set(t.task,"child_taskids",e)},expression:"task.child_taskids"}},t._l(t.taskselect,(function(t){return a("el-option",{key:t.label,attrs:{label:t.label,value:t.value}})})),1)],1)],1),t._v(" "),a("el-col",{attrs:{span:11}},[0!=t.task.child_taskids.length?a("el-form-item",{attrs:{label:"子任务运行策略",prop:"child_runparallel"}},[a("el-select",{attrs:{disabled:t.is_preview},model:{value:t.task.child_runparallel,callback:function(e){t.$set(t.task,"child_runparallel",e)},expression:"task.child_runparallel"}},t._l(t.parallelrun,(function(t){return a("el-option",{key:t.label,attrs:{label:t.label,value:t.value}})})),1)],1):t._e()],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"CronExpr",prop:"cronexpr"}},[a("div",[a("el-popover",{attrs:{transition:"fade-in-linear",width:"700"},model:{value:t.cronPopover,callback:function(e){t.cronPopover=e},expression:"cronPopover"}},[a("cron",{model:{value:t.cronExpression,callback:function(e){t.cronExpression=e},expression:"cronExpression"}}),t._v(" "),a("el-input",{staticStyle:{width:"500px"},attrs:{slot:"reference",disabled:t.is_preview,clearable:"",placeholder:"请输入Cron表达式"},on:{click:function(e){t.cronPopover=!0}},slot:"reference",model:{value:t.task.cronexpr,callback:function(e){t.$set(t.task,"cronexpr",e)},expression:"task.cronexpr"}}),t._v(" "),a("div",{staticStyle:{"text-align":"center"}},[!1===t.is_preview?a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.changeCron}},[t._v("确 定")]):t._e(),t._v(" "),!1===t.is_preview?a("el-button",{attrs:{size:"small"},on:{click:function(e){t.cronPopover=!1}}},[t._v("取 消")]):t._e()],1)],1)],1)]),t._v(" "),t.is_change?a("el-form-item",{attrs:{label:"调度状态",prop:"run"}},[a("el-switch",{attrs:{disabled:t.is_preview,"active-text":"正常调度","inactive-text":"停止调度"},model:{value:t.task.run,callback:function(e){t.$set(t.task,"run",e)},expression:"task.run"}})],1):t._e(),t._v(" "),a("el-form-item",{attrs:{label:"超时时间(s)",prop:"timeout"}},[a("el-input-number",{attrs:{disabled:t.is_preview,"controls-position":"right",min:-1,label:"超时时间"},model:{value:t.task.timeout,callback:function(e){t.$set(t.task,"timeout",e)},expression:"task.timeout"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"路由策略",prop:"route_policy"}},[a("el-select",{attrs:{disabled:t.is_preview},model:{value:t.task.route_policy,callback:function(e){t.$set(t.task,"route_policy",e)},expression:"task.route_policy"}},t._l(t.route_policyoption,(function(t){return a("el-option",{key:t.label,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"报警策略",prop:"alarm_status"}},[a("el-select",{attrs:{disabled:t.is_preview},model:{value:t.task.alarm_status,callback:function(e){t.$set(t.task,"alarm_status",e)},expression:"task.alarm_status"}},t._l(t.alarm_statusoption,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"报警用户",prop:"alarm_userids"}},[a("el-select",{attrs:{disabled:t.is_preview,multiple:"",filterable:""},model:{value:t.task.alarm_userids,callback:function(e){t.$set(t.task,"alarm_userids",e)},expression:"task.alarm_userids"}},t._l(t.userselect,(function(t){return a("el-option",{key:t.label,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"主机组",prop:"host_groupid"}},[a("el-select",{attrs:{disabled:t.is_preview,filterable:""},model:{value:t.task.host_groupid,callback:function(e){t.$set(t.task,"host_groupid",e)},expression:"task.host_groupid"}},t._l(t.hostgroupselect,(function(t){return a("el-option",{key:t.label,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"Expect Code"}},[a("el-input",{staticStyle:{width:"500px"},attrs:{disabled:t.is_preview,type:"number",placeholder:"期望返回码",clearable:""},model:{value:t.task.expect_code,callback:function(e){t.$set(t.task,"expect_code",e)},expression:"task.expect_code"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"Expect Content"}},[t.is_preview?a("el-input",{staticStyle:{width:"500px"},attrs:{disabled:t.is_preview,type:"textarea",placeholder:"",clearable:""},model:{value:t.task.expect_content,callback:function(e){t.$set(t.task,"expect_content",e)},expression:"task.expect_content"}}):a("el-input",{staticStyle:{width:"500px"},attrs:{type:"textarea",placeholder:"期望返回内容",clearable:""},model:{value:t.task.expect_content,callback:function(e){t.$set(t.task,"expect_content",e)},expression:"task.expect_content"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"备注"}},[t.is_preview?a("el-input",{staticStyle:{width:"500px"},attrs:{disabled:t.is_preview,type:"textarea",placeholder:"",clearable:""},model:{value:t.task.remark,callback:function(e){t.$set(t.task,"remark",e)},expression:"task.remark"}}):a("el-input",{staticStyle:{width:"500px"},attrs:{type:"textarea",placeholder:"请输入备注",clearable:""},model:{value:t.task.remark,callback:function(e){t.$set(t.task,"remark",e)},expression:"task.remark"}})],1),t._v(" "),t.is_preview?a("el-form-item",{attrs:{label:"创建时间"}},[a("el-input",{attrs:{disabled:t.is_preview,clearable:""},model:{value:t.taskcreatetime,callback:function(e){t.taskcreatetime=e},expression:"taskcreatetime"}})],1):t._e(),t._v(" "),t.is_preview?a("el-form-item",{attrs:{label:"更新时间"}},[a("el-input",{attrs:{disabled:t.is_preview,clearable:""},model:{value:t.taskupdatetime,callback:function(e){t.taskupdatetime=e},expression:"taskupdatetime"}})],1):t._e()],1),t._v(" "),a("div",{staticStyle:{"margin-left":"120px"}},[!1===t.is_preview?a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.submittask}},[t._v("确 定")]):t._e(),t._v(" "),!1===t.is_preview?a("el-button",{attrs:{size:"small"},on:{click:function(e){t.is_create=!1,t.is_change=!1}}},[t._v("取 消")]):t._e(),t._v(" "),t.is_preview?a("el-button",{attrs:{size:"small"},on:{click:function(e){t.is_preview=!1,t.is_change=!1}}},[t._v("返 回")]):t._e()],1)],1):!0===t.is_running?a("div",[a("div",{staticStyle:{float:"right"}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"任务列表",placement:"top-start"}},[a("el-button",{attrs:{type:"warning",size:"small"},on:{click:t.toTask}},[t._v("Task")])],1)],1),t._v(" "),a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:t.runningdata,stripe:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"任务名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.name))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"CronExpr"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.cronexpr))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"调度时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.start_timestr))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"运行时长"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.run_time))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"触发方式"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.trigger))])]}}])}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button-group",[a("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(a){return t.startopen(e.row)}}},[t._v("实时日志")]),t._v(" "),a("el-popconfirm",{attrs:{hideIcon:!0,title:"确定终止任务?"},on:{onConfirm:function(a){return t.startkilltask(e.row)}}},[a("el-button",{attrs:{slot:"reference",type:"danger",size:"mini"},slot:"reference"},[t._v("终止任务")])],1)],1)]}}])})],1),t._v(" "),a("div",{staticStyle:{"margin-top":"10px",float:"right",height:"70px"}},[a("el-pagination",{attrs:{"page-size":t.runningquery.limit,background:"",layout:"total,prev, pager, next",total:t.pagecount},on:{"current-change":t.handleCurrentChangeruntask}})],1),t._v(" "),a("el-dialog",{attrs:{title:t.diarealtasktitle,visible:t.diarealogVisible,center:"",width:"70%"},on:{"update:visible":function(e){t.diarealogVisible=e},close:t.startclose}},[a("el-container",[a("el-aside",{attrs:{width:"200px"}},[a("el-tree",{attrs:{"highlight-current":"","default-expand-all":!0,data:t.runtaskdata,"render-content":t.renderContent},on:{"node-click":t.handleNodeClick}})],1),t._v(" "),a("el-main",[a("span",{staticClass:"sub-title",domProps:{innerHTML:t._s(t.realtasklogtitle)}}),t._v(" "),a("br"),t._v(" "),""!==t.realtasklogtitle&&""===t.realtasklog?a("span",{staticClass:"sub-title"},[t._v("正在获取任务实时运行日志，请等待...")]):t._e(),t._v(" "),a("el-card",{attrs:{"body-style":{padding:"0px"}}},[""!=t.realtasklog?a("editor",{attrs:{theme:"solarized_dark",lang:"text",height:"400",width:"100%",options:{readOnly:!0}},on:{init:t.initEditor},model:{value:t.realtasklog,callback:function(e){t.realtasklog=e},expression:"realtasklog"}}):t._e()],1)],1)],1)],1)],1)]):a("div",[a("div",{staticStyle:{float:"right"}},[a("el-form",{attrs:{inline:!0,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"任务名称"}},[a("el-input",{staticStyle:{width:"240px","margin-right":"1px"},attrs:{type:"primary",size:"small",placeholder:"请输入任务名称(前置匹配模糊搜索)"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getalltask(e)}},model:{value:t.query.psname,callback:function(e){t.$set(t.query,"psname",e)},expression:"query.psname"}})],1),t._v(" "),a("el-form-item",[!1===t.query.self?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"查看自已创建的任务",placement:"top-start"}},[!1===t.query.self?a("el-button",{attrs:{type:"success",size:"small"},on:{click:function(e){t.query.self=!0,t.getalltask()}}},[t._v("Self")]):t._e()],1):t._e(),t._v(" "),!0===t.query.self?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"查看所有任务",placement:"top-start"}},[!0===t.query.self?a("el-button",{attrs:{type:"success",size:"small"},on:{click:function(e){t.query.self=!1,t.getalltask()}}},[t._v("AllTask")]):t._e()],1):t._e()],1),t._v(" "),a("el-form-item",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"新建任务",placement:"top-start"}},[a("el-button",{attrs:{type:"danger",size:"small"},on:{click:t.createtaskpre}},[t._v("New")])],1)],1),t._v(" "),a("el-form-item",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"查看正在运行的任务",placement:"top-start"}},[a("el-button",{attrs:{type:"warning",size:"small"},on:{click:t.getrunningtaskpre}},[t._v("Running")])],1)],1)],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:t.data,stripe:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",fixed:"left",label:"任务名称","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.name))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"任务类型",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.task_type?a("span",[a("el-tag",{attrs:{size:"small",type:"warning"}},[t._v(t._s(e.row.task_typedesc))]),t._v(" "),a("el-tag",{attrs:{size:"small",type:"danger"}},[t._v(t._s(e.row.task_data.langdesc))])],1):a("span",[a("el-tag",{attrs:{size:"small",type:"warning"}},[t._v(t._s(e.row.task_typedesc))]),t._v(" "),a("el-tag",{attrs:{size:"small",type:"danger"}},[t._v(t._s(e.row.task_data.method))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"路由策略",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.route_policydesc))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"CronExpr","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.cronexpr))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"调度状态",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.run?a("el-tag",{attrs:{size:"mini",type:"success"}},[t._v("Normal")]):a("el-tag",{attrs:{size:"mini",type:"danger"}},[t._v("Stop")])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"超时(s)",width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){return[-1===e.row.timeout?a("span",[t._v("-")]):a("span",[t._v(t._s(e.row.timeout))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"主机组","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.host_group))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"报警策略","min-width":"70"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.alarm_statusdesc))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"创建人",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.create_by))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"备注","min-width":"70"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.remark))])]}}])}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button-group",[a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.changetaskpre(e.row)}}},[t._v("修改")]),t._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"从此任务克隆一个新的任务",placement:"top-start"}},[a("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(a){t.clonevisible=!0,t.clonename=e.row.name,t.cloneid=e.row.id,t.clonenewname=""}}},[t._v("克隆")])],1),t._v(" "),a("el-popconfirm",{attrs:{hideIcon:!0,title:"删除任务后对应的任务日志也会被删除，确定删除任务?"},on:{onConfirm:function(a){return t.startdeletetask(e.row)}}},[a("el-button",{attrs:{slot:"reference",type:"danger",size:"mini"},slot:"reference"},[t._v("删除")])],1)],1),t._v(" "),a("br"),t._v(" "),a("el-button-group",[a("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(a){return t.previewtaskpre(e.row)}}},[t._v("详情")]),t._v(" "),a("el-button",{attrs:{type:"success",size:"mini"}},[a("router-link",{attrs:{to:{name:"Log",query:{name:e.row.name}}}},[t._v("日志")])],1),t._v(" "),a("el-popconfirm",{attrs:{hideIcon:!0,title:"立即运行任务?"},on:{onConfirm:function(a){return t.startruntask(e.row)}}},[a("el-button",{attrs:{slot:"reference",type:"primary",size:"mini"},slot:"reference"},[t._v("运行")])],1)],1)]}}])})],1),t._v(" "),a("div",{staticStyle:{"margin-top":"10px",float:"right",height:"70px"}},[a("el-pagination",{attrs:{"page-size":t.query.limit,background:"",layout:"total,prev, pager, next",total:t.pagecount},on:{"current-change":t.handleCurrentChangetask}})],1),t._v(" "),a("el-dialog",{attrs:{title:t.clonediatitle,center:"",visible:t.clonevisible,width:"20%"},on:{"update:visible":function(e){t.clonevisible=e}}},[a("el-input",{staticStyle:{width:"100%"},attrs:{size:"mini",placeholder:"请输入新的任务名称"},model:{value:t.clonenewname,callback:function(e){t.clonenewname=e},expression:"clonenewname"}}),t._v(" "),a("p"),t._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.startclonetask}},[t._v("确定")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.clonevisible=!1}}},[t._v("取消")])],1)],1)],1)])},l=[],s=(a("a481"),a("28a5"),a("7f7f"),a("6762"),a("2fdb"),a("ac6a"),a("b199")),n=a("5f87"),r=a("c8cc"),o=a("c24f"),c=(a("4360"),a("61f7"),a("5c96")),u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cron",attrs:{val:t.value_}},[a("el-row",[a("el-col",{attrs:{span:18}},[a("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"秒",name:"s"}},[a("second-and-minute",{attrs:{lable:"秒"},model:{value:t.sVal,callback:function(e){t.sVal=e},expression:"sVal"}})],1),t._v(" "),a("el-tab-pane",{attrs:{label:"分",name:"m"}},[a("second-and-minute",{attrs:{lable:"分"},model:{value:t.mVal,callback:function(e){t.mVal=e},expression:"mVal"}})],1),t._v(" "),a("el-tab-pane",{attrs:{label:"时",name:"h"}},[a("hour",{attrs:{lable:"时"},model:{value:t.hVal,callback:function(e){t.hVal=e},expression:"hVal"}})],1),t._v(" "),a("el-tab-pane",{attrs:{label:"日",name:"d"}},[a("day",{attrs:{lable:"日",disable:t.disableday},model:{value:t.dVal,callback:function(e){t.dVal=e},expression:"dVal"}})],1),t._v(" "),a("el-tab-pane",{attrs:{label:"月",name:"month"}},[a("month",{attrs:{lable:"月"},model:{value:t.monthVal,callback:function(e){t.monthVal=e},expression:"monthVal"}})],1),t._v(" "),a("el-tab-pane",{attrs:{label:"周",name:"week"}},[a("week",{attrs:{lable:"周",disable:t.disableweek},model:{value:t.weekVal,callback:function(e){t.weekVal=e},expression:"weekVal"}})],1),t._v(" "),a("el-tab-pane",{attrs:{label:"年",name:"year"}},[a("year",{attrs:{lable:"年"},model:{value:t.yearVal,callback:function(e){t.yearVal=e},expression:"yearVal"}})],1)],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,size:"mini",border:""}},[a("el-table-column",{attrs:{prop:"sVal",label:"秒","min-width":"60"}}),t._v(" "),a("el-table-column",{attrs:{prop:"mVal",label:"分","min-width":"60"}}),t._v(" "),a("el-table-column",{attrs:{prop:"hVal",label:"时","min-width":"60"}}),t._v(" "),a("el-table-column",{attrs:{prop:"dVal",label:"日","min-width":"60"}}),t._v(" "),a("el-table-column",{attrs:{prop:"monthVal",label:"月","min-width":"60"}}),t._v(" "),a("el-table-column",{attrs:{prop:"weekVal",label:"周","min-width":"60"}}),t._v(" "),a("el-table-column",{attrs:{prop:"yearVal",label:"年","min-width":"60"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-collapse",{on:{change:t.handleChange},model:{value:t.collapseactiveName,callback:function(e){t.collapseactiveName=e},expression:"collapseactiveName"}},[a("el-collapse-item",{attrs:{title:"最近运行时间",name:"1"}},t._l(t.cronrecenttime,(function(e){return a("div",{key:e},[a("span",[t._v(t._s(e))])])})),0)],1)],1)],1)],1)},p=[],d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{val:t.value_}},[a("div",[a("el-radio",{attrs:{label:"1",size:"mini",border:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("每"+t._s(t.lable))])],1),t._v(" "),a("div",[a("el-radio",{attrs:{label:"2",size:"mini",border:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("周期")]),t._v(" "),a("span",{staticStyle:{"margin-left":"0px","margin-right":"0px"}},[t._v("从")]),t._v(" "),a("el-input-number",{staticStyle:{width:"100px"},attrs:{min:1,max:59,size:"mini"},on:{change:function(e){t.type="2"}},model:{value:t.cycle.start,callback:function(e){t.$set(t.cycle,"start",e)},expression:"cycle.start"}}),t._v(" "),a("span",{staticStyle:{"margin-left":"0px","margin-right":"0px"}},[t._v("至")]),t._v(" "),a("el-input-number",{staticStyle:{width:"100px"},attrs:{min:2,max:59,size:"mini"},on:{change:function(e){t.type="2"}},model:{value:t.cycle.end,callback:function(e){t.$set(t.cycle,"end",e)},expression:"cycle.end"}}),t._v("\n    "+t._s(t.lable)+"\n  ")],1),t._v(" "),a("div",[a("el-radio",{attrs:{label:"3",size:"mini",border:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("循环")]),t._v(" "),a("span",{staticStyle:{"margin-left":"0px","margin-right":"0px"}},[t._v("从")]),t._v(" "),a("el-input-number",{staticStyle:{width:"100px"},attrs:{min:0,max:59,size:"mini"},on:{change:function(e){t.type="3"}},model:{value:t.loop.start,callback:function(e){t.$set(t.loop,"start",e)},expression:"loop.start"}}),t._v(" "),a("span",{staticStyle:{"margin-left":"0px","margin-right":"5px"}},[t._v(t._s(t.lable)+"开始，每")]),t._v(" "),a("el-input-number",{staticStyle:{width:"100px"},attrs:{min:1,max:59,size:"mini"},on:{change:function(e){t.type="3"}},model:{value:t.loop.end,callback:function(e){t.$set(t.loop,"end",e)},expression:"loop.end"}}),t._v("\n    "+t._s(t.lable)+"执行一次\n  ")],1),t._v(" "),a("div",[a("el-radio",{attrs:{label:"4",size:"mini",border:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("指定")]),t._v(" "),a("el-checkbox-group",{model:{value:t.appoint,callback:function(e){t.appoint=e},expression:"appoint"}},t._l(10,(function(e){return a("div",{key:e},t._l(6,(function(i){return a("el-checkbox",{key:i,attrs:{label:t.check(6*(e-1)+(i-1))},on:{change:function(e){t.type="4"}}})})),1)})),0)],1)])},h=[],v=(a("6b54"),{props:{value:{type:String,default:"*"},lable:{type:String}},data:function(){return{type:"1",cycle:{start:0,end:0},loop:{start:0,end:0},week:{start:0,end:0},work:0,last:0,appoint:[]}},computed:{value_:function(){var t=[];switch(this.type){case"1":t.push("*");break;case"2":t.push("".concat(this.cycle.start,"-").concat(this.cycle.end));break;case"3":t.push("".concat(this.loop.start,"/").concat(this.loop.end));break;case"4":t.push(this.appoint.join(","));break;case"6":t.push("".concat(0===this.last?"":this.last,"L"));break;default:t.push("?");break}return this.$emit("input",t.join("")),t.join("")}},watch:{value:function(t,e){this.updateVal()}},methods:{updateVal:function(){this.value&&("?"===this.value?this.type="5":-1!==this.value.indexOf("-")?2===this.value.split("-").length&&(this.type="2",this.cycle.start=this.value.split("-")[0],this.cycle.end=this.value.split("-")[1]):-1!==this.value.indexOf("/")?2===this.value.split("/").length&&(this.type="3",this.loop.start=this.value.split("/")[0],this.loop.end=this.value.split("/")[1]):-1!==this.value.indexOf("*")?this.type="1":-1!==this.value.indexOf("L")?(this.type="6",this.last=this.value.replace("L","")):-1!==this.value.indexOf("#")?2===this.value.split("#").length&&(this.type="7",this.week.start=this.value.split("#")[0],this.week.end=this.value.split("#")[1]):-1!==this.value.indexOf("W")?(this.type="8",this.work=this.value.replace("W","")):(this.type="4",this.appoint=this.value.split(",")))},check:function(t){return t<10?"0"+t:t.toString()}},created:function(){this.updateVal()}}),m=v,b=(a("b325"),a("2877")),f=Object(b["a"])(m,d,h,!1,null,null,null),_=f.exports,k=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{val:t.value_}},[a("div",[a("el-radio",{attrs:{label:"1",size:"mini",border:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("每时")])],1),t._v(" "),a("div",[a("el-radio",{attrs:{label:"2",size:"mini",border:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("周期")]),t._v(" "),a("span",{staticStyle:{"margin-left":"0px","margin-right":"0px"}},[t._v("从")]),t._v(" "),a("el-input-number",{staticStyle:{width:"100px"},attrs:{min:0,max:23,size:"mini"},on:{change:function(e){t.type="2"}},model:{value:t.cycle.start,callback:function(e){t.$set(t.cycle,"start",e)},expression:"cycle.start"}}),t._v(" "),a("span",{staticStyle:{"margin-left":"0px","margin-right":"0px"}},[t._v("至")]),t._v(" "),a("el-input-number",{staticStyle:{width:"100px"},attrs:{min:2,max:23,size:"mini"},on:{change:function(e){t.type="2"}},model:{value:t.cycle.end,callback:function(e){t.$set(t.cycle,"end",e)},expression:"cycle.end"}}),t._v("\n    时\n  ")],1),t._v(" "),a("div",[a("el-radio",{attrs:{label:"3",size:"mini",border:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("循环")]),t._v(" "),a("span",{staticStyle:{"margin-left":"0px","margin-right":"0px"}},[t._v("从")]),t._v(" "),a("el-input-number",{staticStyle:{width:"100px"},attrs:{min:0,max:23,size:"mini"},on:{change:function(e){t.type="3"}},model:{value:t.loop.start,callback:function(e){t.$set(t.loop,"start",e)},expression:"loop.start"}}),t._v(" "),a("span",{staticStyle:{"margin-left":"0px","margin-right":"0px"}},[t._v("时开始，每")]),t._v(" "),a("el-input-number",{staticStyle:{width:"100px"},attrs:{min:1,max:23,size:"mini"},on:{change:function(e){t.type="3"}},model:{value:t.loop.end,callback:function(e){t.$set(t.loop,"end",e)},expression:"loop.end"}}),t._v("\n    时执行一次\n  ")],1),t._v(" "),a("div",[a("el-radio",{attrs:{label:"4",size:"mini",border:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("指定")]),t._v(" "),a("el-checkbox-group",{model:{value:t.appoint,callback:function(e){t.appoint=e},expression:"appoint"}},t._l(4,(function(e){return a("div",{key:e},t._l(6,(function(i){return a("el-checkbox",{key:i,attrs:{label:t.check(6*(e-1)+(i-1))},on:{change:function(e){t.type="4"}}})})),1)})),0)],1)])},y=[],g={props:{value:{type:String,default:"*"}},data:function(){return{type:"1",cycle:{start:0,end:0},loop:{start:0,end:0},week:{start:0,end:0},work:0,last:0,appoint:[]}},computed:{value_:function(){var t=[];switch(this.type){case"1":t.push("*");break;case"2":t.push("".concat(this.cycle.start,"-").concat(this.cycle.end));break;case"3":t.push("".concat(this.loop.start,"/").concat(this.loop.end));break;case"4":t.push(this.appoint.join(","));break;case"6":t.push("".concat(0===this.last?"":this.last,"L"));break;default:t.push("?");break}return this.$emit("input",t.join("")),t.join("")}},watch:{value:function(t,e){this.updateVal()}},methods:{updateVal:function(){this.value&&("?"===this.value?this.type="5":-1!==this.value.indexOf("-")?2===this.value.split("-").length&&(this.type="2",this.cycle.start=this.value.split("-")[0],this.cycle.end=this.value.split("-")[1]):-1!==this.value.indexOf("/")?2===this.value.split("/").length&&(this.type="3",this.loop.start=this.value.split("/")[0],this.loop.end=this.value.split("/")[1]):-1!==this.value.indexOf("*")?this.type="1":-1!==this.value.indexOf("L")?(this.type="6",this.last=this.value.replace("L","")):-1!==this.value.indexOf("#")?2===this.value.split("#").length&&(this.type="7",this.week.start=this.value.split("#")[0],this.week.end=this.value.split("#")[1]):-1!==this.value.indexOf("W")?(this.type="8",this.work=this.value.replace("W","")):(this.type="4",this.appoint=this.value.split(",")))},check:function(t){return t<10?"0"+t:t.toString()}},created:function(){this.updateVal()}},x=g,w=(a("4d1b"),Object(b["a"])(x,k,y,!1,null,null,null)),S=w.exports,z=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{val:t.value_}},[a("div",[a("el-radio",{attrs:{disabled:t.disable,label:"1",size:"mini",border:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("每日")])],1),t._v(" "),a("div",[a("el-radio",{attrs:{disabled:t.disable,label:"5",size:"mini",border:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("不指定")])],1),t._v(" "),a("div",[a("el-radio",{attrs:{disabled:t.disable,label:"2",size:"mini",border:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("周期")]),t._v(" "),a("span",{staticStyle:{"margin-left":"0px","margin-right":"0px"}},[t._v("从")]),t._v(" "),a("el-input-number",{staticStyle:{width:"100px"},attrs:{disabled:t.disable,min:1,max:31,size:"mini"},on:{change:function(e){t.type="2"}},model:{value:t.cycle.start,callback:function(e){t.$set(t.cycle,"start",e)},expression:"cycle.start"}}),t._v(" "),a("span",{staticStyle:{"margin-left":"0px","margin-right":"0px"}},[t._v("至")]),t._v(" "),a("el-input-number",{staticStyle:{width:"100px"},attrs:{disabled:t.disable,min:2,max:31,size:"mini"},on:{change:function(e){t.type="2"}},model:{value:t.cycle.end,callback:function(e){t.$set(t.cycle,"end",e)},expression:"cycle.end"}}),t._v("日\n  ")],1),t._v(" "),a("div",[a("el-radio",{attrs:{disabled:t.disable,label:"3",size:"mini",border:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("循环")]),t._v(" "),a("span",{staticStyle:{"margin-left":"0px","margin-right":"0px"}},[t._v("从")]),t._v(" "),a("el-input-number",{staticStyle:{width:"100px"},attrs:{disabled:t.disable,min:1,max:31,size:"mini"},on:{change:function(e){t.type="3"}},model:{value:t.loop.start,callback:function(e){t.$set(t.loop,"start",e)},expression:"loop.start"}}),t._v(" "),a("span",{staticStyle:{"margin-left":"0px","margin-right":"0px"}},[t._v("日开始，每")]),t._v(" "),a("el-input-number",{staticStyle:{width:"100px"},attrs:{disabled:t.disable,min:1,max:31,size:"mini"},on:{change:function(e){t.type="3"}},model:{value:t.loop.end,callback:function(e){t.$set(t.loop,"end",e)},expression:"loop.end"}}),t._v("日执行一次\n  ")],1),t._v(" "),a("div",[a("el-radio",{attrs:{disabled:t.disable,label:"8",size:"mini",border:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("工作日")]),t._v(" "),a("span",{staticStyle:{"margin-left":"0px","margin-right":"0px"}},[t._v("本月")]),t._v(" "),a("el-input-number",{staticStyle:{width:"100px"},attrs:{disabled:t.disable,min:1,max:7,size:"mini"},on:{change:function(e){t.type="8"}},model:{value:t.work,callback:function(e){t.work=e},expression:"work"}}),t._v("号，最近的工作日\n  ")],1),t._v(" "),a("div",[a("el-radio",{attrs:{disabled:t.disable,label:"6",size:"mini",border:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("本月最后一天")])],1),t._v(" "),a("div",[a("el-radio",{attrs:{disabled:t.disable,label:"4",size:"mini",border:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("指定")]),t._v(" "),a("el-checkbox-group",{model:{value:t.appoint,callback:function(e){t.appoint=e},expression:"appoint"}},t._l(6,(function(e){return a("div",{key:e},t._l(6,(function(i){return 6*(e-1)+i<32?a("el-checkbox",{key:i,attrs:{disabled:t.disable,label:t.check(6*(e-1)+i)},on:{change:function(e){t.type="4"}}}):t._e()})),1)})),0)],1)])},V=[],O={props:{value:{type:String,default:"?"},disable:{type:Boolean}},data:function(){return{type:"5",cycle:{start:0,end:0},loop:{start:0,end:0},week:{start:0,end:0},work:0,last:0,appoint:[]}},computed:{value_:function(){var t=[];switch(this.type){case"1":t.push("*");break;case"2":t.push("".concat(this.cycle.start,"-").concat(this.cycle.end));break;case"3":t.push("".concat(this.loop.start,"/").concat(this.loop.end));break;case"4":t.push(this.appoint.join(","));break;case"6":t.push("".concat(0===this.last?"":this.last,"L"));break;case"7":t.push("".concat(this.week.start,"#").concat(this.week.end));break;case"8":t.push("".concat(this.work,"W"));break;default:t.push("?");break}return this.$emit("input",t.join("")),t.join("")}},watch:{value:function(t,e){this.updateVal()}},methods:{updateVal:function(){this.value&&("?"===this.value?this.type="5":-1!==this.value.indexOf("-")?2===this.value.split("-").length&&(this.type="2",this.cycle.start=this.value.split("-")[0],this.cycle.end=this.value.split("-")[1]):-1!==this.value.indexOf("/")?2===this.value.split("/").length&&(this.type="3",this.loop.start=this.value.split("/")[0],this.loop.end=this.value.split("/")[1]):-1!==this.value.indexOf("*")?this.type="1":-1!==this.value.indexOf("L")?(this.type="6",this.last=this.value.replace("L","")):-1!==this.value.indexOf("#")?2===this.value.split("#").length&&(this.type="7",this.week.start=this.value.split("#")[0],this.week.end=this.value.split("#")[1]):-1!==this.value.indexOf("W")?(this.type="8",this.work=this.value.replace("W","")):(this.type="4",this.appoint=this.value.split(",")))},check:function(t){return t<10?"0"+t:t.toString()}},created:function(){this.updateVal()}},$=O,j=(a("f7b0"),Object(b["a"])($,z,V,!1,null,null,null)),C=j.exports,E=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{val:t.value_}},[a("div",[a("el-radio",{attrs:{label:"1",size:"mini",border:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("每月")])],1),t._v(" "),a("div",[a("el-radio",{attrs:{label:"5",size:"mini",border:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("不指定")])],1),t._v(" "),a("div",[a("el-radio",{attrs:{label:"2",size:"mini",border:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("周期")]),t._v(" "),a("span",{staticStyle:{"margin-left":"0px","margin-right":"0px"}},[t._v("从")]),t._v(" "),a("el-input-number",{staticStyle:{width:"100px"},attrs:{min:1,max:12,size:"mini"},on:{change:function(e){t.type="2"}},model:{value:t.cycle.start,callback:function(e){t.$set(t.cycle,"start",e)},expression:"cycle.start"}}),t._v(" "),a("span",{staticStyle:{"margin-left":"0px","margin-right":"0px"}},[t._v("至")]),t._v(" "),a("el-input-number",{staticStyle:{width:"100px"},attrs:{min:2,max:12,size:"mini"},on:{change:function(e){t.type="2"}},model:{value:t.cycle.end,callback:function(e){t.$set(t.cycle,"end",e)},expression:"cycle.end"}}),t._v("\n    月\n  ")],1),t._v(" "),a("div",[a("el-radio",{attrs:{label:"3",size:"mini",border:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("循环")]),t._v(" "),a("span",{staticStyle:{"margin-left":"0px","margin-right":"0px"}},[t._v("从")]),t._v(" "),a("el-input-number",{staticStyle:{width:"100px"},attrs:{min:1,max:12,size:"mini"},on:{change:function(e){t.type="3"}},model:{value:t.loop.start,callback:function(e){t.$set(t.loop,"start",e)},expression:"loop.start"}}),t._v(" "),a("span",{staticStyle:{"margin-left":"0px","margin-right":"0px"}},[t._v("月开始，每")]),t._v(" "),a("el-input-number",{staticStyle:{width:"100px"},attrs:{min:1,max:12,size:"mini"},on:{change:function(e){t.type="3"}},model:{value:t.loop.end,callback:function(e){t.$set(t.loop,"end",e)},expression:"loop.end"}}),t._v("\n    月执行一次\n  ")],1),t._v(" "),a("div",[a("el-radio",{attrs:{label:"4",size:"mini",border:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("指定")]),t._v(" "),a("el-checkbox-group",{model:{value:t.appoint,callback:function(e){t.appoint=e},expression:"appoint"}},t._l(2,(function(e){return a("div",{key:e},t._l(6,(function(i){return a("el-checkbox",{key:i,attrs:{label:t.check(6*(e-1)+i)},on:{change:function(e){t.type="4"}}})})),1)})),0)],1)])},L=[],q={props:{value:{type:String,default:"*"}},data:function(){return{type:"1",cycle:{start:0,end:0},loop:{start:0,end:0},week:{start:0,end:0},work:0,last:0,appoint:[]}},computed:{value_:function(){var t=[];switch(this.type){case"1":t.push("*");break;case"2":t.push("".concat(this.cycle.start,"-").concat(this.cycle.end));break;case"3":t.push("".concat(this.loop.start,"/").concat(this.loop.end));break;case"4":t.push(this.appoint.join(","));break;case"6":t.push("".concat(0===this.last?"":this.last,"L"));break;default:t.push("?");break}return this.$emit("input",t.join("")),t.join("")}},watch:{value:function(t,e){this.updateVal()}},methods:{updateVal:function(){this.value&&("?"===this.value?this.type="5":-1!==this.value.indexOf("-")?2===this.value.split("-").length&&(this.type="2",this.cycle.start=this.value.split("-")[0],this.cycle.end=this.value.split("-")[1]):-1!==this.value.indexOf("/")?2===this.value.split("/").length&&(this.type="3",this.loop.start=this.value.split("/")[0],this.loop.end=this.value.split("/")[1]):-1!==this.value.indexOf("*")?this.type="1":-1!==this.value.indexOf("L")?(this.type="6",this.last=this.value.replace("L","")):-1!==this.value.indexOf("#")?2===this.value.split("#").length&&(this.type="7",this.week.start=this.value.split("#")[0],this.week.end=this.value.split("#")[1]):-1!==this.value.indexOf("W")?(this.type="8",this.work=this.value.replace("W","")):(this.type="4",this.appoint=this.value.split(",")))},check:function(t){return t<10?"0"+t:t.toString()}},created:function(){this.updateVal()}},T=q,N=(a("f59d"),Object(b["a"])(T,E,L,!1,null,null,null)),M=N.exports,P=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{val:t.value_}},[a("div",[a("el-radio",{attrs:{disabled:t.disable,label:"1",size:"mini",border:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("每周")])],1),t._v(" "),a("div",[a("el-radio",{attrs:{disabled:t.disable,label:"5",size:"mini",border:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("不指定")])],1),t._v(" "),a("div",[a("el-radio",{attrs:{disabled:t.disable,label:"2",size:"mini",border:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("周期")]),t._v(" "),a("span",{staticStyle:{"margin-left":"-5px","margin-right":"0px"}},[t._v("从星期")]),t._v(" "),a("el-input-number",{staticStyle:{width:"100px"},attrs:{disabled:t.disable,min:1,max:7,size:"mini"},on:{change:function(e){t.type="2"}},model:{value:t.cycle.start,callback:function(e){t.$set(t.cycle,"start",e)},expression:"cycle.start"}}),t._v(" "),a("span",{staticStyle:{"margin-left":"0px","margin-right":"0px"}},[t._v("至星期")]),t._v(" "),a("el-input-number",{staticStyle:{width:"100px"},attrs:{disabled:t.disable,min:2,max:7,size:"mini"},on:{change:function(e){t.type="2"}},model:{value:t.cycle.end,callback:function(e){t.$set(t.cycle,"end",e)},expression:"cycle.end"}})],1),t._v(" "),a("div",[a("el-radio",{attrs:{disabled:t.disable,label:"3",size:"mini",border:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("循环")]),t._v(" "),a("span",{staticStyle:{"margin-left":"-5px","margin-right":"0px"}},[t._v("从星期")]),t._v(" "),a("el-input-number",{staticStyle:{width:"100px"},attrs:{disabled:t.disable,min:1,max:7,size:"mini"},on:{change:function(e){t.type="3"}},model:{value:t.loop.start,callback:function(e){t.$set(t.loop,"start",e)},expression:"loop.start"}}),t._v(" "),a("span",{staticStyle:{"margin-left":"0px","margin-right":"0px"}},[t._v("开始，每")]),t._v(" "),a("el-input-number",{staticStyle:{width:"100px"},attrs:{disabled:t.disable,min:1,max:7,size:"mini"},on:{change:function(e){t.type="3"}},model:{value:t.loop.end,callback:function(e){t.$set(t.loop,"end",e)},expression:"loop.end"}}),t._v("\n    天执行一次\n  ")],1),t._v(" "),a("div",[a("el-radio",{attrs:{disabled:t.disable,label:"7",size:"mini",border:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("指定周")]),t._v(" "),a("span",{staticStyle:{"margin-left":"0px","margin-right":"0px"}},[t._v("本月第")]),t._v(" "),a("el-input-number",{staticStyle:{width:"100px"},attrs:{disabled:t.disable,min:1,max:4,size:"mini"},on:{change:function(e){t.type="7"}},model:{value:t.week.start,callback:function(e){t.$set(t.week,"start",e)},expression:"week.start"}}),t._v(" "),a("span",{staticStyle:{"margin-left":"0px","margin-right":"0px"}},[t._v("周，星期")]),t._v(" "),a("el-input-number",{staticStyle:{width:"100px"},attrs:{disabled:t.disable,min:1,max:7,size:"mini"},on:{change:function(e){t.type="7"}},model:{value:t.week.end,callback:function(e){t.$set(t.week,"end",e)},expression:"week.end"}})],1),t._v(" "),a("div",[a("el-radio",{attrs:{disabled:t.disable,label:"6",size:"mini",border:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("本月最后一个")]),t._v(" "),a("span",{staticStyle:{"margin-left":"0px","margin-right":"0px"}},[t._v("星期")]),t._v(" "),a("el-input-number",{staticStyle:{width:"100px"},attrs:{disabled:t.disable,min:1,max:7,size:"mini"},on:{change:function(e){t.type="6"}},model:{value:t.last,callback:function(e){t.last=e},expression:"last"}})],1),t._v(" "),a("div",[a("el-radio",{attrs:{disabled:t.disable,label:"4",size:"mini",border:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("指定")]),t._v(" "),a("el-checkbox-group",{model:{value:t.appoint,callback:function(e){t.appoint=e},expression:"appoint"}},t._l(7,(function(e){return a("el-checkbox",{key:e,attrs:{disabled:t.disable,label:e},on:{change:function(e){t.type="4"}}})})),1)],1)])},W=[],A={props:{value:{type:String,default:"*"},disable:{type:Boolean}},data:function(){return{type:"1",cycle:{start:0,end:0},loop:{start:0,end:0},week:{start:0,end:0},work:0,last:0,appoint:[]}},computed:{value_:function(){var t=[];switch(this.type){case"1":t.push("*");break;case"2":t.push("".concat(this.cycle.start,"-").concat(this.cycle.end));break;case"3":t.push("".concat(this.loop.start,"/").concat(this.loop.end));break;case"4":t.push(this.appoint.join(","));break;case"6":t.push("".concat(0===this.last?"":this.last,"L"));break;case"7":t.push("".concat(this.week.start,"#").concat(this.week.end));break;default:t.push("?");break}return this.$emit("input",t.join("")),t.join("")}},watch:{value:function(t,e){this.updateVal()}},methods:{updateVal:function(){this.value&&("?"===this.value?this.type="5":-1!==this.value.indexOf("-")?2===this.value.split("-").length&&(this.type="2",this.cycle.start=this.value.split("-")[0],this.cycle.end=this.value.split("-")[1]):-1!==this.value.indexOf("/")?2===this.value.split("/").length&&(this.type="3",this.loop.start=this.value.split("/")[0],this.loop.end=this.value.split("/")[1]):-1!==this.value.indexOf("*")?this.type="1":-1!==this.value.indexOf("L")?(this.type="6",this.last=this.value.replace("L","")):-1!==this.value.indexOf("#")?2===this.value.split("#").length&&(this.type="7",this.week.start=this.value.split("#")[0],this.week.end=this.value.split("#")[1]):-1!==this.value.indexOf("W")?(this.type="8",this.work=this.value.replace("W","")):(this.type="4",this.appoint=this.value.split(",")))}},created:function(){this.updateVal()}},R=A,I=(a("bf7f"),Object(b["a"])(R,P,W,!1,null,null,null)),D=I.exports,H=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{val:t.value_}},[a("div",[a("el-radio",{attrs:{label:"1",size:"mini",border:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("每年")])],1),t._v(" "),a("div",[a("el-radio",{attrs:{label:"5",size:"mini",border:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("不指定")])],1),t._v(" "),a("div",[a("el-radio",{attrs:{label:"2",size:"mini",border:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[t._v("周期")]),t._v(" "),a("span",{staticStyle:{"margin-left":"0px","margin-right":"0px"}},[t._v("从")]),t._v(" "),a("el-input-number",{staticStyle:{width:"100px"},attrs:{min:2e3,size:"mini"},on:{change:function(e){t.type="2"}},model:{value:t.cycle.start,callback:function(e){t.$set(t.cycle,"start",e)},expression:"cycle.start"}}),t._v(" "),a("span",{staticStyle:{"margin-left":"0px","margin-right":"0px"}},[t._v("至")]),t._v(" "),a("el-input-number",{staticStyle:{width:"100px"},attrs:{min:2e3,size:"mini"},on:{change:function(e){t.type="2"}},model:{value:t.cycle.end,callback:function(e){t.$set(t.cycle,"end",e)},expression:"cycle.end"}}),t._v("\n    年\n  ")],1)])},G=[],B={props:{value:{type:String,default:"*"}},data:function(){var t=(new Date).getFullYear();return{type:"1",cycle:{start:t,end:t},loop:{start:0,end:0},week:{start:0,end:0},work:0,last:0,appoint:[]}},computed:{value_:function(){var t=[];switch(this.type){case"1":t.push("*");break;case"2":t.push("".concat(this.cycle.start,"-").concat(this.cycle.end));break;case"3":t.push("".concat(this.loop.start,"/").concat(this.loop.end));break;case"4":t.push(this.appoint.join(","));break;case"6":t.push("".concat(0===this.last?"":this.last,"L"));break;default:t.push("?");break}return this.$emit("input",t.join("")),t.join("")}},watch:{value:function(t,e){this.updateVal()}},methods:{updateVal:function(){this.value&&("?"===this.value?this.type="5":-1!==this.value.indexOf("-")?2===this.value.split("-").length&&(this.type="2",this.cycle.start=this.value.split("-")[0],this.cycle.end=this.value.split("-")[1]):-1!==this.value.indexOf("/")?2===this.value.split("/").length&&(this.type="3",this.loop.start=this.value.split("/")[0],this.loop.end=this.value.split("/")[1]):-1!==this.value.indexOf("*")?this.type="1":-1!==this.value.indexOf("L")?(this.type="6",this.last=this.value.replace("L","")):-1!==this.value.indexOf("#")?2===this.value.split("#").length&&(this.type="7",this.week.start=this.value.split("#")[0],this.week.end=this.value.split("#")[1]):-1!==this.value.indexOf("W")?(this.type="8",this.work=this.value.replace("W","")):(this.type="4",this.appoint=this.value.split(",")))}},created:function(){this.updateVal()}},F=B,J=(a("6e49"),Object(b["a"])(F,H,G,!1,null,null,null)),U=J.exports,Y={props:{value:{type:String}},data:function(){return{activeName:"s",collapseactiveName:["1"],sVal:"",mVal:"",hVal:"",dVal:"",monthVal:"",weekVal:"",yearVal:"",cronrecenttime:[],disableweek:!1,disableday:!1}},watch:{value:function(t,e){this.updateVal(),this.handleChange()}},computed:{tableData:function(){return[{sVal:this.sVal,mVal:this.mVal,hVal:this.hVal,dVal:this.dVal,monthVal:this.monthVal,weekVal:this.weekVal,yearVal:this.yearVal}]},value_:function(){if(!this.dVal&&!this.weekVal)return"";"?"===this.dVal?this.disableweek=!1:this.disableweek=!0,"?"===this.weekVal?this.disableday=!1:this.disableday=!0;var t="".concat(this.sVal," ").concat(this.mVal," ").concat(this.hVal," ").concat(this.dVal," ").concat(this.monthVal," ").concat(this.weekVal," ").concat(this.yearVal);return t!==this.value&&this.$emit("input",t),t}},methods:{updateVal:function(){if(this.value){var t=this.value.split(" ");this.sVal=t[0],this.mVal=t[1],this.hVal=t[2],this.dVal=t[3],this.monthVal=t[4],this.weekVal=t[5],this.yearVal=t[6]}},handleChange:function(){var t=this;if(""!==this.value){var e={expr:window.btoa(this.value)};Object(s["l"])(e).then((function(e){t.cronrecenttime=e.data}))}}},created:function(){this.updateVal(),this.handleChange()},components:{SecondAndMinute:_,hour:S,day:C,month:M,week:D,year:U}},K=Y,Q=(a("4282"),Object(b["a"])(K,u,p,!1,null,null,null)),X=Q.exports,Z={components:{editor:a("7c9e"),cron:X},computed:{CronCollapse:function(){return"点击查看【".concat(this.cronExpression,"】最近五次的运行时间")},clonediatitle:function(){return"克隆任务 ".concat(this.clonename)}},watch:{"task.cronexpr":{handler:function(t,e){this.cronExpression=t},deep:!0,immediate:!0}},data:function(){return{listLoading:!1,cronexprdialog:!1,createjobdialog:!1,task:{id:"",name:"",task_type:"",task_data:{},parent_taskids:[],parent_runparallel:!1,child_taskids:[],child_runparallel:!1,host_groupid:"",timeout:-1,run:!1,cronexpr:"",alarm_userids:[],route_policy:1,expect_code:0,expect_content:"",alarm_status:-1,remark:""},status_options:[{value:!1,label:"正常"},{value:!0,label:"停止"}],task_typeoption:[{value:1,label:"Code"},{value:2,label:"API"}],parallelrun:[{value:!0,label:"并行"},{value:!1,label:"串行"}],route_policyoption:[{value:1,label:"Random"},{value:2,label:"RoundRobin"},{value:3,label:"Weight"},{value:4,label:"LeastTask"}],alarm_statusoption:[{value:-2,label:"Always"},{value:-1,label:"Fail"},{value:1,label:"Success"}],data:[],runningdata:[],pagecount:0,rules:{name:[{required:!0,message:"请输入任务名称",trigger:"blur"}],task_type:[{required:!0,message:"请选择任务类型",trigger:"blur"}],cronexpr:[{required:!0,message:"请输入Cron表达式",trigger:"blur"}],timeout:[{required:!0,message:"请输入超时时间",trigger:"change"}],route_policy:[{required:!0,message:"请选择路由策略",trigger:"blur"}],alarm_status:[{required:!0,message:"请选择报警策略",trigger:"blur"}],alarm_userids:[{required:!0,message:"请选择报警用户",trigger:"blur"}],host_groupid:[{required:!0,message:"请选择主机组",trigger:"blur"}]},is_change:!1,is_create:!1,is_running:!1,is_preview:!1,savecode:{lang:1,code:""},langoption:[{value:1,label:"shell"},{value:2,label:"python3"},{value:3,label:"golang"}],lang:{1:"powershell",2:"python",3:"golang"},saveapi:{url:"",method:"GET",payload:"",header:{}},method:"",url:"",methodoption:[{value:"GET",label:"GET"},{value:"HEAD",label:"HEAD"},{value:"POST",label:"POST"},{value:"PUT",label:"PUT"},{value:"PATCH",label:"PATCH"},{value:"DELETE",label:"DELETE"}],content_type:"",content_typeoption:[{value:"application/json",label:"application/json"},{value:"application/x-www-form-urlencoded",label:"application/x-www-form-urlencoded"}],headerlist:[{}],methodurl:[{}],content_typetable:[{}],formlist:[{}],bodylist:[{}],cronPopover:!1,cronExpression:"",jsonplayload:"",query:{offset:0,limit:15,self:!1,psname:""},runningquery:{offset:0,limit:15},examplecode:{1:'#!/usr/bin/env sh\nfunction main() {\n    echo "run shell"\n}\n\nmain\n        ',2:"#!/usr/bin/env python3\ndef main():\n    print(\"run python\")\n\nif __name__ == '__main__':\n    main()",3:'package main\n\nimport "fmt"\n\nfunc main() {\n\tfmt.Println("run golang")\n}'},hostgroupselect:[],userselect:[],taskselect:[],dialogVisible:!1,diarealogVisible:!1,trsocket:null,tlsocket:null,runtaskdata:[],diarealtasktitle:"",diatasktitle:"",runningInterval:void 0,realtasklog:"",realtasklogtitle:"",currenttasklogid:"",taskcreatetime:"",taskupdatetime:"",selftask:!0,clonenewname:"",cloneid:"",clonename:"",clonevisible:!1}},created:function(){this.getalltask()},methods:{getalltask:function(){var t=this;Object(s["h"])(this.query).then((function(e){t.data=e.data,t.pagecount=e.count}))},submittask:function(){var t=this;if(this.task.expect_code=parseInt(this.task.expect_code),isNaN(this.task.expect_code)&&c["Message"].error("Execpt Code only allow is number"),1===this.task.task_type)this.task.task_data=this.savecode;else if(2===this.task.task_type){if(this.headerlist.forEach((function(e){""!==e.key&&(t.saveapi.header[e.key]=e.value)})),!1===["GET","HEAD"].includes(this.saveapi.method))if("application/x-www-form-urlencoded"===this.content_type){var e=[];this.formlist.forEach((function(t){""!==t.key&&e.push("".concat(t.key,"=").concat(t.value))})),this.saveapi.payload=e.join("&")}else"application/json"===this.content_type&&(this.saveapi.payload=this.jsonplayload);this.task.task_data=this.saveapi}else console.log("err: support task type",this.task.task_type);if(!0===this.is_create)delete this.task.id,Object(s["d"])(this.task).then((function(e){0===e.code?(c["Message"].success("创建任务 ".concat(t.task.name," 成功")),t.getalltask(),t.is_create=!1):c["Message"].error("创建任务 ".concat(t.task.name," 失败: ").concat(e.msg))}));else if(!0===this.is_change){var a=this.task.name;Object(s["a"])(this.task).then((function(e){0===e.code?(c["Message"].success("修改任务 ".concat(a," 成功")),t.getalltask(),t.is_change=!1):c["Message"].error("修改任务 ".concat(a," 失败: ").concat(e.msg))}))}},startdeletetask:function(t){var e=this,a={id:t.id};Object(s["e"])(a).then((function(a){0===a.code?(e.getalltask(),c["Message"].success("删除任务".concat(t.name,"成功"))):c["Message"].error("删除任务".concat(t.name,"失败: ").concat(a.msg))}))},startkilltask:function(t){var e={id:t.id};Object(s["k"])(e).then((function(e){0===e.code?c["Message"].success("终止任务 ".concat(t.name," 成功")):c["Message"].error("终止任务 ".concat(t.name," 失败: ").concat(e.msg))}))},startruntask:function(t){var e={id:t.id};Object(s["m"])(e).then((function(e){0===e.code?c["Message"].success("任务 ".concat(t.name," 已经开始运行")):c["Message"].error("运行任务".concat(t.name,"失败: ").concat(e.msg))}))},changelang:function(){this.savecode.code=this.examplecode[this.savecode.lang]},edit_header:function(){this.saveapi.header["Content-Type"]=this.content_type},initEditor:function(t){a("2099"),a("a669"),a("8882"),a("bb36"),a("8a2a"),a("818b"),a("32ff"),a("6c73")},addheader:function(){this.headerlist.push({})},deleteheaderRow:function(t){this.headerlist.splice(t,1)},addform:function(){this.formlist.push({})},deleteformRow:function(t){this.formlist.splice(t,1)},generatedict:function(t){},changeCron:function(){this.task.cronexpr=this.cronExpression,this.cronPopover=!1},changetaskdata:function(){1===this.task.task_type?(!0===this.is_create&&(this.task.expect_code=0,this.savecode.code=this.examplecode[this.savecode.lang]),this.task.task_data=this.savecode):2===this.task.task_type&&(!0===this.is_create&&(this.task.expect_code=200),this.task.task_data=this.saveapi)},createtaskpre:function(){void 0==this.task.name?this.tasl["name"]="":this.task.name="",this.task.run=!0,this.task.task_type="",this.task.task_data={},this.task.parent_taskids=[],this.task.child_taskids=[],this.task.host_groupid=[],this.task.timeout=-1,this.task.cronexpr="",this.task.alarm_userids=[],this.task.route_policy=1,this.task.expect_code=0,this.task.expect_content="",this.task.alarm_status=-1,this.task.remark="",this.is_create=!0,this.savecode={lang:1,code:""},this.saveapi={url:"",method:"GET",payload:"",header:{}},this.jsonplayload="",this.headerlist=[{}],this.methodurl=[{}],this.content_typetabl=[{}],this.formlist=[{}],this.bodylist=[{}],this.getselect()},getselect:function(){var t=this;Object(s["g"])().then((function(e){t.taskselect=e.data})),Object(r["f"])().then((function(e){t.hostgroupselect=e.data})),Object(o["h"])().then((function(e){t.userselect=e.data}))},changetaskpre:function(t){var e=this;if(this.getselect(),void 0===this.task.id?this.task["id"]=t.id:this.task.id=t.id,this.task.name=t.name,this.task.run=t.run,this.task.task_type=t.task_type,this.task_data=t.task_data,this.task.parent_taskids=t.parent_taskids,this.task.parent_runparallel=t.parent_runparallel,this.task.child_taskids=t.child_taskids,this.task.child_runparallel=t.child_runparallel,this.task.host_groupid=t.host_groupid,this.task.timeout=t.timeout,this.task.cronexpr=t.cronexpr,this.task.alarm_userids=t.alarm_userids,this.task.route_policy=t.route_policy,this.task.expect_code=t.expect_code,this.task.expect_content=t.expect_content,this.task.alarm_status=t.alarm_status,this.task.remark=t.remark,this.is_change=!0,1===this.task.task_type&&(this.savecode=t.task_data),2===this.task.task_type){for(var a in this.saveapi=t.task_data,this.headerlist=[],this.saveapi.header)"Content-Type"!==a&&this.headerlist.push({key:a,value:this.saveapi.header[a]});0===this.headerlist.length&&this.headerlist.push({}),this.content_type=this.saveapi.header["Content-Type"],"application/json"==this.content_type&&(this.jsonplayload=this.saveapi.payload),"application/x-www-form-urlencoded"===this.content_type&&(this.formlist=[],""!==this.saveapi.payload&&this.saveapi.payload.split("&").forEach((function(t){var a=t.split("=");e.formlist.push({key:a[0],value:a[1]})})),0===this.formlist.length&&this.formlist.push({}))}},previewtaskpre:function(t){this.is_preview=!0,this.taskcreatetime=t.create_time,this.taskupdatetime=t.update_time,this.changetaskpre(t)},getrunningtaskpre:function(t){this.is_running=!0,this.getrundatafunc(t),this.runningInterval=setInterval(this.getrundatafunc,5e3)},getrundatafunc:function(t){var e=this;Object(s["f"])(t).then((function(t){e.runningdata=t.data,e.pagecount=t.count}))},handleCurrentChangetask:function(t){this.query.offset=(t-1)*this.query.limit,this.getalltask(this.query)},handleCurrentChangeruntask:function(t){this.runningquery.offset=(t-1)*this.runningquery.limit,this.getrunningtaskpre()},startopen:function(t){var e=this;this.realtasklogtitle="",this.realtasklog="",this.currenttasklogid=t.id,this.diarealtasktitle="实时任务日志: ".concat(t.name),this.diarealogVisible=!0;var a=Object(n["a"])(),i="";i="".concat(location.origin);var l="".concat(i.replace("http","ws"),"/api/v1/task/status/websocket?id=").concat(t.id);this.trsocket=new WebSocket(l),this.trsocket.onopen=function(t){e.trsocket.send(a)},this.trsocket.onmessage=function(t){e.runtaskdata=JSON.parse(t.data),e.trsocket.send("ok")}},startclose:function(){null!==this.trsocket&&(console.log("start close websocket task run status"),this.trsocket.close()),null!==this.tlsocket&&(console.log("start close websocket task log status"),this.tlsocket.close())},handleNodeClick:function(t,e,a){var i=this;if(void 0!=t.id){null!==this.tlsocket&&this.tlsocket.close();var l={1:"主任务",2:"父任务",3:"子任务"};this.realtasklogtitle="".concat(l[t.tasktype]," ").concat(t.name,"[").concat(t.id,"]"),this.realtasklog="";var s=Object(n["a"])(),r="";r="".concat(location.origin);var o="".concat(r.replace("http","ws"),"/api/v1/task/log/websocket?id=").concat(this.currenttasklogid,"&realid=").concat(t.id,"&type=").concat(t.tasktype);console.log("start conn websocket ".concat(o)),this.tlsocket=new WebSocket(o),this.tlsocket.onopen=function(t){i.tlsocket.send(s)},this.tlsocket.onmessage=function(t){i.realtasklog=i.realtasklog+t.data,i.tlsocket.send("ok")}}},renderContent:function(t,e){e.node;var a=e.data;e.store;return t("span",{class:"custom-tree-node"},[t("svg-icon",{attrs:{"icon-class":a.status}}),t("span",{style:"margin-left:5px;"},[a.name])])},toTask:function(){this.is_running=!1,window.clearInterval(this.runningInterval)},startclonetask:function(){var t=this,e={id:this.cloneid,name:this.clonenewname};Object(s["c"])(e).then((function(e){0===e.code?(c["Message"].success("克隆任务成功"),t.clonevisible=!1,t.getalltask()):c["Message"].error("克隆任务失败 ".concat(e.msg))}))}}},tt=Z,et=(a("1b4f"),Object(b["a"])(tt,i,l,!1,null,"12fbe380",null));e["default"]=et.exports},c44d:function(t,e,a){},c8cc:function(t,e,a){"use strict";a.d(e,"d",(function(){return l})),a.d(e,"f",(function(){return s})),a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return r})),a.d(e,"a",(function(){return o})),a.d(e,"e",(function(){return c}));var i=a("b775");function l(t){return Object(i["a"])({url:"/api/v1/hostgroup",method:"get",params:t})}function s(){return Object(i["a"])({url:"/api/v1/hostgroup/select",method:"get"})}function n(t){return Object(i["a"])({url:"/api/v1/hostgroup",method:"post",data:t})}function r(t){return Object(i["a"])({url:"/api/v1/hostgroup",method:"delete",data:t})}function o(t){return Object(i["a"])({url:"/api/v1/hostgroup",method:"put",data:t})}function c(t){return Object(i["a"])({url:"/api/v1/hostgroup/hosts",method:"get",params:t})}},e3cc:function(t,e,a){},f59d:function(t,e,a){"use strict";var i=a("c44d"),l=a.n(i);l.a},f7b0:function(t,e,a){"use strict";var i=a("4a41"),l=a.n(i);l.a}}]);